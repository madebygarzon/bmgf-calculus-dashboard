<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Average Textbook Price by Publisher</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --deep-insight: #008384;
            --scholar-blue: #234A5D;
            --warm-thoughts: #4A81A8;
            --sky-logic: #4A81A8;
            --coastal-clarity: #7FBFC0;
            --soft-lecture: #92A4CF;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter Tight', sans-serif;
            background: transparent;
            overflow: hidden;
        }
        .container {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 20px 20px 15px;
            gap: 14px;
        }
        .publisher-row {
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transform: translateX(-20px);
            animation: slideIn 0.4s ease forwards;
        }
        .publisher-row:nth-child(1) { animation-delay: 0.1s; }
        .publisher-row:nth-child(2) { animation-delay: 0.2s; }
        .publisher-row:nth-child(3) { animation-delay: 0.3s; }
        .publisher-row:nth-child(4) { animation-delay: 0.4s; }
        .publisher-row:nth-child(5) { animation-delay: 0.5s; }
        .publisher-row:nth-child(6) { animation-delay: 0.6s; }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .logo-container {
            width: 70px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .logo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .logo-placeholder {
            font-size: 9px;
            font-weight: 600;
            color: var(--scholar-blue);
            text-align: center;
            background: #F0F2F5;
            border-radius: 4px;
            padding: 6px 4px;
            width: 100%;
        }
        .bar-container {
            flex: 1;
            height: 30px;
            background: #F0F2F5;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        .bar-fill {
            height: 100%;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0;
        }
        .bar-value {
            font-size: 13px;
            font-weight: 700;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .bar-value-outside {
            font-size: 13px;
            font-weight: 700;
            color: var(--scholar-blue);
            margin-left: 10px;
            min-width: 50px;
        }

        .cengage .bar-fill { background: linear-gradient(90deg, #008384, #00a5a7); }
        .pearson .bar-fill { background: linear-gradient(90deg, #234A5D, #3a6a82); }
        .wiley .bar-fill { background: linear-gradient(90deg, #4A81A8, #6a9fc4); }
        .macmillan .bar-fill { background: linear-gradient(90deg, #234A5D, #3a6a82); }
        .openstax .bar-fill { background: linear-gradient(90deg, #7FBFC0, #9dd4d5); }
        .other .bar-fill { background: linear-gradient(90deg, #92A4CF, #b0bee0); }

        .avg-label {
            font-size: 10px;
            color: #6B7280;
            text-align: center;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <!-- Generated by JS -->
    </div>

    <script>
        // Default data
        const defaultPublishers = [
            { name: 'Cengage', value: 180, class: 'cengage', logo: '../assets/publisher_logos/cengage-learning-seeklogo.png' },
            { name: 'Pearson', value: 162, class: 'pearson', logo: '../assets/publisher_logos/pearson-seeklogo.png' },
            { name: 'Wiley', value: 155, class: 'wiley', logo: '../assets/publisher_logos/cdnlogo.com_wiley.png' },
            { name: 'Macmillan', value: 148, class: 'macmillan', logo: null },
            { name: 'Other', value: 120, class: 'other', logo: null },
            { name: 'OpenStax', value: 43, class: 'openstax', logo: '../assets/publisher_logos/open_stax_logo.png' }
        ];

        // Map publisher names to CSS classes and logos
        const publisherMeta = {
            'Cengage': { class: 'cengage', logo: '../assets/publisher_logos/cengage-learning-seeklogo.png' },
            'Pearson': { class: 'pearson', logo: '../assets/publisher_logos/pearson-seeklogo.png' },
            'Wiley': { class: 'wiley', logo: '../assets/publisher_logos/cdnlogo.com_wiley.png' },
            'Macmillan': { class: 'macmillan', logo: null },
            'Other': { class: 'other', logo: null },
            'OpenStax': { class: 'openstax', logo: '../assets/publisher_logos/open_stax_logo.png' }
        };

        // Build publishers from dynamic data if available
        let publishers;
        if (window.BMGF_DATA && window.BMGF_DATA.publishers && window.BMGF_DATA.publishers.length > 0) {
            publishers = window.BMGF_DATA.publishers
                .map(p => ({
                    name: p.name,
                    value: Math.round(p.avg_price || 0),
                    class: (publisherMeta[p.name] || {}).class || 'other',
                    logo: (publisherMeta[p.name] || {}).logo || null
                }))
                .sort((a, b) => b.value - a.value);
        } else {
            publishers = defaultPublishers;
        }

        const container = document.getElementById('container');

        publishers.forEach((pub, index) => {
            const row = document.createElement('div');
            row.className = `publisher-row ${pub.class}`;

            const showValueOutside = false;

            row.innerHTML = `
                <div class="logo-container">
                    ${pub.logo
                        ? `<img src="${pub.logo}" alt="${pub.name}" onerror="this.parentElement.innerHTML='<div class=\\'logo-placeholder\\'>${pub.name}</div>'">`
                        : `<div class="logo-placeholder">${pub.name}</div>`
                    }
                </div>
                <div class="bar-container">
                    <div class="bar-fill" id="bar-${index}" style="width: 0%">
                        ${!showValueOutside ? `<span class="bar-value">$${pub.value}</span>` : ''}
                    </div>
                </div>
                ${showValueOutside ? `<span class="bar-value-outside">$${pub.value}</span>` : ''}
            `;

            container.appendChild(row);
        });

        const avgLabel = document.createElement('div');
        avgLabel.className = 'avg-label';
        avgLabel.textContent = 'Average Textbook Price (USD)';
        container.appendChild(avgLabel);

        const maxValue = Math.max(...publishers.map(p => p.value));
        const minWidth = 28; // Ensure $43 fits inside
        const maxWidth = 95;

        setTimeout(() => {
            publishers.forEach((pub, index) => {
                const bar = document.getElementById(`bar-${index}`);
                const normalizedValue = Math.sqrt(pub.value / maxValue);
                const width = normalizedValue * (maxWidth - minWidth) + minWidth;
                bar.style.width = `${width}%`;
            });
        }, 300);
    </script>
</body>
</html>
