<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cover Page - Calculus II Enrollment</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --deep-insight: #008384;
            --scholar-blue: #234A5D;
            --coastal-clarity: #7FBFC0;
            --warm-thoughts: #4A81A8;
            --sky-logic: #4A81A8;
            --soft-lecture: #92A4CF;
            --lavender: #D3DEF6;
            --white: #FFFFFF;
            --background: #F6F6F6;
            --text-dark: #234A5D;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter Tight', sans-serif;
            background: var(--white);
            margin: 0;
            padding: 0;
        }

        .section-container {
            background: var(--white);
            padding: 20px 24px;
            width: 100%;
            height: 100%;
        }

        .chart-group {
            margin-bottom: 16px;
        }

        .chart-group:last-child {
            margin-bottom: 0;
        }

        .chart-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--scholar-blue);
            margin-bottom: 12px;
        }

        .lollipop-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 4px 0;
            border-radius: 4px;
        }

        .lollipop-row:hover {
            background: rgba(74, 129, 168, 0.05);
        }

        .lollipop-row:hover .lollipop-circle {
            transform: scale(1.2);
            box-shadow: 0 0 0 4px rgba(74, 129, 168, 0.15);
        }

        .lollipop-label {
            width: 140px;
            font-size: 11px;
            color: var(--text-dark);
            padding-right: 8px;
            flex-shrink: 0;
        }

        .lollipop-label .percentage {
            color: var(--warm-thoughts);
            font-weight: 600;
        }

        .lollipop-track {
            flex: 1;
            height: 2px;
            background: var(--lavender);
            position: relative;
            margin-right: 8px;
        }

        .lollipop-line {
            height: 2px;
            background: var(--warm-thoughts);
            position: absolute;
            left: 0;
            top: 0;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .lollipop-circle {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--warm-thoughts);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            right: -6px;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .lollipop-value {
            width: 70px;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-dark);
            text-align: right;
        }

        .sector-2year .lollipop-line,
        .sector-2year .lollipop-circle {
            background: var(--warm-thoughts);
        }

        .sector-4private .lollipop-line,
        .sector-4private .lollipop-circle {
            background: var(--coastal-clarity);
        }

        .sector-4public .lollipop-line,
        .sector-4public .lollipop-circle {
            background: var(--sky-logic);
        }

        .tooltip {
            position: fixed;
            background: var(--scholar-blue);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .tooltip.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="section-container">
        <!-- By Region -->
        <div class="chart-group">
            <div class="chart-label">By Region</div>
            <div id="regionChart"></div>
        </div>

        <!-- By Sector -->
        <div class="chart-group">
            <div class="chart-label">By Sector</div>
            <div id="sectorChart"></div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Use dynamic data from admin panel if available, otherwise use defaults
        const defaultRegionData = [
            { name: 'Southeast', percentage: 30, value: 184478 },
            { name: 'Far West', percentage: 18, value: 110847 },
            { name: 'Great Lakes', percentage: 16, value: 98423 },
            { name: 'Southwest', percentage: 12, value: 75325 },
            { name: 'Mid East', percentage: 12, value: 75108 },
            { name: 'Rocky Mountains', percentage: 6, value: 36519 },
            { name: 'Plains', percentage: 3, value: 20183 },
            { name: 'New England', percentage: 2, value: 13438 },
            { name: 'Outlying Areas', percentage: 0, value: 618 }
        ];

        const defaultSectorData = [
            { name: '4-Year Public', percentage: 71, value: 433669, class: 'sector-4public' },
            { name: '2-Year Public', percentage: 15, value: 93914, class: 'sector-2year' },
            { name: '4-Year Private', percentage: 14, value: 87356, class: 'sector-4private' }
        ];

        // Map sector names to CSS classes
        const sectorClassMap = {
            '4-Year Public': 'sector-4public',
            '2-Year Public': 'sector-2year',
            '4-Year Private': 'sector-4private'
        };

        // Get data from window.BMGF_DATA if available
        const regionData = (window.BMGF_DATA && window.BMGF_DATA.regional && window.BMGF_DATA.regional.calc2)
            ? window.BMGF_DATA.regional.calc2
            : defaultRegionData;

        const sectorData = (window.BMGF_DATA && window.BMGF_DATA.sectors && window.BMGF_DATA.sectors.calc2)
            ? window.BMGF_DATA.sectors.calc2.map(s => ({ ...s, class: sectorClassMap[s.name] || '' }))
            : defaultSectorData;

        const tooltip = document.getElementById('tooltip');

        function createLollipopChart(containerId, data, maxPercentage = null) {
            const container = document.getElementById(containerId);
            const max = maxPercentage || Math.max(...data.map(d => d.percentage));

            data.forEach((item, index) => {
                const width = (item.percentage / max) * 100;
                const row = document.createElement('div');
                row.className = `lollipop-row ${item.class || ''}`;

                row.innerHTML = `
                    <div class="lollipop-label">
                        ${item.name} <span class="percentage">(${item.percentage}%)</span>
                    </div>
                    <div class="lollipop-track">
                        <div class="lollipop-line" style="width: 0%">
                            <div class="lollipop-circle"></div>
                        </div>
                    </div>
                    <div class="lollipop-value">${item.value.toLocaleString()}</div>
                `;

                setTimeout(() => {
                    const line = row.querySelector('.lollipop-line');
                    line.style.width = width + '%';
                }, 100 + index * 50);

                row.addEventListener('mouseenter', (e) => {
                    tooltip.innerHTML = `<strong>${item.name}</strong><br>${item.value.toLocaleString()} students (${item.percentage}%)`;
                    tooltip.classList.add('show');
                });

                row.addEventListener('mousemove', (e) => {
                    tooltip.style.left = e.clientX + 10 + 'px';
                    tooltip.style.top = e.clientY - 30 + 'px';
                });

                row.addEventListener('mouseleave', () => {
                    tooltip.classList.remove('show');
                });

                container.appendChild(row);
            });
        }

        createLollipopChart('regionChart', regionData, 30);
        createLollipopChart('sectorChart', sectorData, 70);
    </script>
</body>
</html>
